<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Interactive Player Preview</title>
    <style>
      body { margin: 0; display:flex; align-items:center; justify-content:center; height:100vh; background:#111; color:#fff }
      .container { width:100%; max-width:480px; text-align:center }
      #player { width:100%; height:480px; border-radius:12px; overflow:hidden; background:#000 }
      .msg { margin-top:8px; color:#ddd; font-size:13px }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="player">Loading player...</div>
      <div class="msg" id="status">Waiting for props...</div>
    </div>

    <script type="module">
      import React from 'https://esm.sh/react@18.2.0';
      import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
      import { Player } from 'https://esm.sh/@remotion/player@4.0.0';

      const root = ReactDOM.createRoot(document.getElementById('player'));

      function App() {
        const [props, setProps] = React.useState({});
        React.useEffect(() => {
          function onMessage(e) {
            if (e.origin !== window.location.origin) return;
            if (e.data?.type === 'live-player-props') {
              setProps(e.data.props || {});
              document.getElementById('status').textContent = 'Props updated';
            }
          }
          window.addEventListener('message', onMessage);
          return () => window.removeEventListener('message', onMessage);
        }, []);

        return React.createElement(Player, {
          src: '/bundle/index.html',
          composition: 'TopMateRecap2025',
          inputProps: props,
          autoPlay: true,
          loop: true,
          showControls: true,
          style: { width: '100%', height: '100%' },
        });
      }

      root.render(React.createElement(App));

      // Notify parent that player is ready
      window.parent && window.parent.postMessage({ type: 'preview-player-ready' }, window.location.origin);
    </script>
  </body>
</html>